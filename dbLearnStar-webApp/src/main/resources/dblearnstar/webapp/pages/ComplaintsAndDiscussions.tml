<html t:type="layout" title="message:ComplaintsAndDiscussions-page"
	xmlns:t="http://tapestry.apache.org/schema/tapestry_5_4.xsd"
	xmlns:p="tapestry:parameter">

<h1>${message:ComplaintsAndDiscussionForSolution-label}</h1>

<div t:type="if" t:test="solutionAssessmentToDiscuss">
	<p:then>
		<h2>${solutionAssessmentToDiscuss.studentSubmitSolution.taskInTestInstance.testInstance.title}</h2>
		<h3>${solutionAssessmentToDiscuss.studentSubmitSolution.taskInTestInstance.task.title}

		</h3>
		
		<P>
			<a class="btn btn-sm btn-outline-info" role="button"
				data-toggle="collapse"
				href="#collapse${solutionAssessmentToDiscuss.solutionAssessmentId}"
				aria-expanded="false"
				aria-controls="collapse${solutionAssessmentToDiscuss.solutionAssessmentId}">
				${message:Description-label} <img t:type="svgicon"
				t:path="chevrons-down" />
			</a>
		</P>
		
		<div class="collapse"
			id="collapse${solutionAssessmentToDiscuss.solutionAssessmentId}">
			<t:outputRaw
				t:value="solutionAssessmentToDiscuss.studentSubmitSolution.taskInTestInstance.task.description" />
		</div>

		<div class="row">
			<div class="col-sm-7">
				<h4>${message:Discussed-Solution-by-label}
					${solutionAssessmentToDiscuss.studentSubmitSolution.studentStartedTest.student.person.lastName}
					${solutionAssessmentToDiscuss.studentSubmitSolution.studentStartedTest.student.person.firstName}
				</h4>
				<div class="reshenieto">
					<pre><t:outputRaw
							t:value="solutionAssessmentToDiscuss.studentSubmitSolution.submission" /></pre>
				</div>
			</div>
			<div class="col-sm-5">
				<div class="card bg-light">
					<div class="card-header">
						<h5>${message:Evaluation-label}</h5>
						<div class="row">
							<div class="col-6">${message:grade-label}:
								${solutionAssessmentToDiscuss.grade}</div>
							<div class="col-6">${solutionAssessmentToDiscuss.evaluatedOn}</div>
						</div>
					</div>
					<div class="card-body feedback"
						style="font-size: 80% !important; line-height: 0.8em !important;">
						<t:outputRaw t:value="solutionAssessmentToDiscuss.feedback" />
					</div>
				</div>

				<div t:type="if" t:test="newAssessmentDiscussion">
					<p:then>
						<t:ModalBox t:id="assessmentModal"
							t:additionalClassDialog="modal-lg">
							<div class="alert alert-warning col-11" role="alert">
								<t:SVGIcon t:path="alert-triangle" />
								${message:discussionForm-description}
							</div>
							<form t:type="beaneditform" t:id="newAssessmentDiscussionForm"
								t:exclude="assessmentDiscussionId, replyTo,type, postedOn, person, solutionEvaluation"
								t:object="newAssessmentDiscussion" class="form-vertical">
								<p:message>
									<t:label t:for="message" />
									<t:textarea t:id="message"
										t:value="newAssessmentDiscussion.message" t:mixins="WebEditor"
										t:WebEditor.areaType="CK" />
								</p:message>
							</form>
							<a href="" t:type="actionlink"
								t:id="cancelNewAssessmentDiscussionForm"
								class="btn btn-secondary ml-2">Cancel</a>
						</t:ModalBox>
					</p:then>
				</div>

				<div t:type="if"
					t:test="solutionAssessmentToDiscuss.assessmentDiscussions">
					<p:then>
						<t:loop t:source="reorderedAssessmentDiscussions"
							t:value="runningAssessmentDiscussion">
							<div class="discussion card ${indentation}">
								<p style="text-align: right">${runningAssessmentDiscussion.postedOn}
									- ${runningAssessmentDiscussion.person.lastName}
									${runningAssessmentDiscussion.person.firstName}</p>
								<p>
									<t:outputRaw t:value="runningAssessmentDiscussion.message" />
								</p>
								<div class="row">
									<button href="" role="button"
										class="btn btn-sm btn-primary  col-auto" t:type="actionlink"
										t:id="replyTo" t:context="runningAssessmentDiscussion">${message:replyTo-label}</button>
									<t:if t:test="administrator">
										<button href="" role="button"
											class="btn btn-sm btn-danger col-auto" t:type="actionlink"
											t:id="deleteDiscussion"
											t:context="runningAssessmentDiscussion" t:mixins="confirm"
											t:message="brishenje">${message:delete-label}</button>
									</t:if>
								</div>
							</div>
						</t:loop>
					</p:then>
					<p:else>
						<p>There are no discussions at this moment.</p>
						<div t:type="if" t:test="YourSolution">
							<p:then>
								<button href="" role="button" class="btn btn-primary"
									t:type="actionlink" t:id="fileAComplaint">
									<img t:type="svgicon" t:path="file-text" />
									${message:fileAComplaint-label}
								</button>

							</p:then>
							<p:else>
								<p class="bg-danger">You can only file a complaint for your
									own solutions.</p>
							</p:else>
						</div>
					</p:else>
				</div>
			</div>
		</div>
	</p:then>
	<p:else>
	Nothing to discuss here.
	</p:else>
</div>
</html>
